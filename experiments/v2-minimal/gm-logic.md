# GM ロジック（最小構成3人版）

## ゲーム設定

**プレイヤー**: アキラ、ユミ、タケシ
**役職**: 村人1、占い師1、人狼1

---

## 初期化処理

### 役職配布（ランダム）
```
roles = ["村人", "占い師", "人狼"]
shuffle(roles)
assign to [アキラ, ユミ, タケシ]
```

### 各プレイヤーへの初期情報

**村人**:
- 自分が村人であること
- 他2人の役職は不明

**占い師**:
- 自分が占い師であること
- 初日夜の占い結果（任意の1人を占う）

**人狼**:
- 自分が人狼であること
- 他2人は村人陣営（村人or占い師）

---

## ゲーム進行

### 1日目昼フェーズ

1. **議論開始宣言**
2. **各プレイヤーに発言を求める**（Task agent 起動）
   - 発言順: ランダムまたは順番
   - 各プレイヤーは他の発言を見てから自分の発言を決める
3. **投票フェーズ**
   - 全員が投票先を決定
   - 自分以外に投票
4. **集計・処刑判定**
   - 最多得票者を処刑
   - 同票の場合: 処刑なし

### 処刑後の判定

- 人狼が処刑された → **村人陣営勝利**
- 村人/占い師が処刑された → 残り2人（人狼1 + 村人陣営1）→ **人狼陣営勝利**
- 処刑なし → 夜フェーズへ

### 夜フェーズ

1. **占い師の行動**（生存している場合）
   - 占い先を選択
   - 結果を占い師にのみ通知
2. **人狼の行動**
   - 襲撃先を選択
   - 襲撃実行

### 襲撃後の判定

- 占い師が襲撃された → 残り2人（人狼1 + 村人1）→ **人狼陣営勝利**
- 村人が襲撃された → 残り2人（人狼1 + 占い師1）→ 2日目昼へ

---

## 情報管理（重要）

### GMが管理する情報（全て秘匿）

| 情報 | 公開先 |
|------|--------|
| 各プレイヤーの役職 | 本人のみ |
| 占い結果 | 占い師本人のみ |
| 襲撃先 | 人狼本人のみ（結果は全員に公開） |
| 投票先 | 集計後に全員に公開 |

### 各プレイヤーが知れる情報

- 自分の役職
- 公開された発言
- 投票結果
- 死亡者（処刑/襲撃）
- 占い師は自分の占い結果

---

## Task agent 起動テンプレート

```
プレイヤー「{name}」としてAI人狼をプレイしてください。

{player-prompt.md の内容}

変数:
- player_name: {name}
- role: {role}
- player_list: アキラ、ユミ、タケシ
- phase: {current_phase}
- alive_players: {alive_list}
- known_info: {role_specific_info}
- game_log: {public_log}
```

---

## 出力の処理

各プレイヤーの出力から:
1. 【思考】部分 → GMのみ保存（デバッグ用）
2. 【発言】部分 → 全員に公開するログに追加
3. 【行動】部分 → GMが処理（投票集計、夜行動実行）
