# 戦術分析フレームワーク

## 目的

ゲーム実行前に戦術を考察し、構造的に破綻しているパターンを排除する。

**このフレームワークでできること**:
- 論理的に破綻している戦術の排除
- 構造的に成立しない連携の発見
- メタ循環の予測

**このフレームワークでできないこと**:
- プレイングミスの予測
- 読み違いの予測
- 想定外の行動の予測

→ これらは `games/` でのゲーム検証で観察する。

---

## 分析ステップ

### ステップ1: 基本戦術の列挙

**問い**: この構成で各役職が取れる行動は何か？

```
例（5人村・村2占1狼1狂1）:
- 占い師: 即CO / 潜伏
- 人狼: 潜伏 / 占い師騙り / 村人騙り
- 狂人: 潜伏 / 占い師騙り / 最速占い師CO
- 村人: 発言で推理 / 寡黙
```

### ステップ2: 前提の抽出

**問い**: その戦術が有効になる前提は何か？

```
例:
戦術: 「真占い師が最速CO」
前提: 「村人は最速CO = 真目と判断する」
```

**チェックポイント**:
- その前提は常に成り立つか？
- その前提を知っている人は誰か？（村人/人狼/狂人）

### ステップ3: 前提への攻撃

**問い**: その前提を逆手に取る戦術はあるか？

```
例:
前提: 「最速CO = 真目」
攻撃: 人狼が最速COすれば真目を得られる
```

### ステップ4: メタの連鎖

**問い**: 対策の対策は？それは循環するか収束するか？

```
Stage 1: 真占い最速CO（前提: 最速=真目）
    ↓ 攻撃
Stage 2: 人狼最速CO（真目を偽装）
    ↓ 攻撃
Stage 3: 狂人最速CO（人狼を引き出す）
    ↓ 攻撃
Stage 4: 全員「最速=狂人」と読む → 潜伏
    ↓
狂人孤立、戦術破綻 → Stage 1に戻る？
```

**打ち切り基準**:
- 3段階で循環したら「読み合い」として記録
- 収束したら「最適解」として記録
- 破綻したら「破綻パターン」として記録

### ステップ5: 破綻判定

**問い**: 論理的に勝ち筋がなくなる分岐はあるか？

```
例:
戦術: 「人狼が村人CO」（3人村）
破綻理由: 占い師COが出た瞬間、消去法で詰む
判定: 破綻
```

**破綻の種類**:
| 種類 | 説明 |
|------|------|
| 論理破綻 | 役職構成上、成立しない |
| 確率破綻 | 勝率が著しく低い（閾値: 10%以下？） |
| メタ破綻 | メタ循環で自滅する |

---

## 構造的問題の発見

戦術考察では、個別の戦術だけでなく「構造的問題」を発見することが重要。

**構造的問題の例**:
- 狂人と人狼がお互いを識別できない
- 騎士がいないと占い師以外の村人が確定噛み対象になる
- 3COすると狂人・人狼の連携が自動成立する

**発見方法**:
- 「この役職は誰の正体を知っているか？」を整理
- 「この行動の結果、誰が得をするか？」を分析
- 「この構成で人狼陣営/村人陣営が必ず取れる行動は？」を列挙

---

## 記録フォーマット

考察結果は `compositions/` に構成別で記録する。

```yaml
# compositions/5p-v2o1w1m1.yaml
composition: "5人（村人2、占い師1、人狼1、狂人1）"
date: "YYYY-MM-DD"

structural_issues:
  - issue: "狂人と人狼が互いを識別できない"
    impact: "狂人がグレー投票で人狼を吊るリスク"

tactics_analysis:
  - tactic: "人狼初日占いCO"
    premise: "狂人が追従して3CO"
    attack: "村人が『3CO = 人狼混じり』と読む"
    meta_stage: 2
    conclusion: "有効（ただし村人の合意次第）"

  - tactic: "狂人最速占いCO"
    premise: "人狼を引き出したい"
    attack: "全員が『最速 = 狂人』と読む"
    meta_stage: 3
    conclusion: "メタ循環、読み合いに収束"

invalid_patterns:
  - tactic: "人狼が村人CO"
    reason: "占い師COで消去法で詰む"
    type: "論理破綻"

open_questions:
  - "村人2人が票を合わせる確率は？"
  - "投票順による戦術差はどの程度か？"
```

---

## games/ との連携

**考察 → 検証のフロー**:

```
tactics/ で仮説を立てる
    ↓
games/ でゲーム実行
    ↓
結果を照合
├── 仮説通り → 信頼度を上げる
├── 想定外 → 考察の穴を発見、修正
└── プレイングミス → ロバスト性の事例として記録
```

**検証後のフィードバック**:
- 考察が正しければ `confidence: 高` に更新
- 考察が外れていれば修正または削除
- 新しい構造的問題を発見したら追記
